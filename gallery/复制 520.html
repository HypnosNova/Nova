<!DOCTYPE html>
<html>

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>Empty Framework</title>
  </head>

  <body>
    <script src="https://cdn.bootcss.com/lodash.js/4.17.5/lodash.min.js"></script>
    <script src="../lib/three.min.js"></script>
    <script src="../build/nova.js"></script>
    <script>
      let app = new NOVA.App();

      let loadingWorld = new NOVA.World( app );
      app.world = loadingWorld;
      var shapes = [];
      init();

      function init() {
        loadingWorld.camera.position.set( 1000, 50, 10 );
        loadingWorld.camera.lookAt( loadingWorld.scene.position );

        var light = new THREE.DirectionalLight( 0x9955ff, 2 );
        light.position.x = -500;
        light.position.y = 500;
        loadingWorld.scene.add( light );

        var light = new THREE.DirectionalLight( 0x9955ff, 1 );
        light.position.x = 500;
        light.position.y = -500;
        light.position.z = -150;
        loadingWorld.scene.add( light );

        loadingWorld.scene.background = new THREE.Color( '#993355' );

        var x = -25,
          y = -250;
        var heartShape = new THREE.Shape();
        heartShape.moveTo( x + 25, y + 25 );
        heartShape.bezierCurveTo( x + 25, y + 25, x + 20, y, x, y );
        heartShape.bezierCurveTo( x - 30, y, x - 30, y + 35, x - 30, y + 35 );
        heartShape.bezierCurveTo( x - 30, y + 55, x - 10, y + 77, x + 25, y + 95 );
        heartShape.bezierCurveTo( x + 60, y + 77, x + 80, y + 55, x + 80, y + 35 );
        heartShape.bezierCurveTo( x + 80, y + 35, x + 80, y, x + 50, y );
        heartShape.bezierCurveTo( x + 35, y, x + 25, y + 25, x + 25, y + 25 );

        var extrudeSettings = { amount: 1, bevelEnabled: true, bevelSegments: 20, steps: 2, bevelSize: 20, bevelThickness: 10 };

        for ( var i = -window.innerWidth / 2; i < window.innerWidth / 2; i += 60 + Math.random() * 50 ) {
          for ( var j = 0; j < 100; j += 60 + Math.random() * 50 ) {
            addShape( heartShape, extrudeSettings, '#ff0022',
              Math.random() * 0.8, Math.random() * 0.8, Math.PI, 0.1 + Math.random() * 0.3 );
          }
        }

        loadingWorld.logicLoop.add( () => {
          animate();
        } );
      }

      function addShape( shape, extrudeSettings, color, rx, ry, rz, s ) {
        var geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );
        var mesh = new THREE.Mesh( geometry, new THREE.MeshPhongMaterial( { color: color } ) );
        mesh.position.set( Math.random() * 400 - 200, Math.random() * 400 - 200, Math.random() * 400 - 200 );
        mesh.rotation.set( rx, ry, rz );
        mesh.scale.set( s, s, s );
        shapes.push( { shape: mesh, x: Math.random(), y: Math.random(), z: Math.random() } );
        loadingWorld.scene.add( mesh );
      }

      function animate() {
        var speed = 0.05;
        shapes.forEach( el => {
          el.shape.rotation.x += el.x * speed;
          el.shape.rotation.y += el.y * speed;
          el.shape.rotation.z += el.z * speed;
        } );
      }
    </script>
  </body>

</html>